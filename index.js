myObj = {"log":[[[0,0,0],[25000,25000,25000,25000],[21],[],[13,17,22,23,23,24,28,29,33,36,38,39,41],[46,45,15,37,44,25,36,"c222324",12,23,"c161517"],[60,60,39,41,60,29,28,33,25,36,22],[13,51,21,24,27,35,37,38,38,42,43,43,45],[13,28,24,12,46,29,35,44,13,38,32],[21,45,42,43,60,35,60,60,43,12,60],[15,16,17,18,21,24,29,31,33,39,42,45,46],[52,14,17,42,11,26,31,36,12,53],[45,46,21,29,60,39,17,60,60,31],[11,11,18,18,19,22,31,41,43,44,47,47,47],[31,34,14,34,"p111111",33,19,26,16,"p313131"],[19,60,60,43,41,44,22,60,19,16],["和了",[0,-1300,0,1300],[3,1,3,"40符1飜1300点","役牌 中(1飜)"]]],[[1,0,0],[25000,23700,25000,26300],[15],[],[17,18,28,29,37,38,41,41,42,43,44,45,46],[21,"4141p41",36,32,21,29],[43,42,21,46,60,45],[12,13,51,22,23,24,25,25,27,28,34,37,41],[47,14,32,22,35,28,14],[60,41,37,22,32,12,14],[12,15,17,18,19,23,24,27,53,36,45,47,47],[35,42,"4747p47","c222324",17,44,16],[12,45,42,36,27,60],[11,12,15,16,18,26,27,29,31,35,38,38,46],[24,47,21,39,38,13],[31,60,60,46,39,29],["和了",[-1000,-2000,4000,-1000],[2,2,2,"30符3飜1000-2000点","役牌 中(1飜)","ドラ(1飜)","赤ドラ(1飜)"]]],[[2,0,0],[24000,21700,29000,25300],[21],[14],[15,15,16,19,21,23,25,27,29,32,33,34,42],[14,28,47,43,33,42,37,24,39,25,43,34,45,45,17,11,16],[42,19,60,60,21,60,60,33,60,60,60,"r15",60,60,60,60,60],[17,19,22,22,23,23,26,28,32,33,38,44,46],[42,35,34,34,"2222p22",46,29,43,"c333234",24,27,27,26,44,32,42,14],[60,46,19,38,17,60,60,44,43,28,60,60,24,60,60,60,60],[13,13,51,17,18,22,28,31,32,33,36,43,45],[47,29,18,44,35,12,11,31,37,13,16,36,36,24,24,44],[45,47,43,60,22,17,28,60,"r29",60,60,60,60,60,60,60],[12,17,19,26,29,31,53,38,39,41,45,46,47],[38,36,12,21,46,"46p4646",39,18,52,"3939p39",27,47,11,31,18,41,38],[29,12,60,47,21,31,26,41,45,52,60,60,19,36,17,18,11],["和了",[0,-7700,9700,0],[2,1,2,"40符3飜7700点","立直(1飜)","赤ドラ(1飜)","裏ドラ(1飜)"]]],[[2,1,0],[23000,14000,37700,25300],[39],[],[14,15,18,22,22,28,28,28,33,41,44,44,46],[14,36,46,17,13,23,47,11,21,45,31,26,43,42,37,42,32],[46,41,60,33,36,14,22,60,"r47",60,60,60,60,60,60,60,60],[11,19,22,24,25,27,27,29,34,37,38,44,45],[19,25,12,38,45,11,16,43,21,14,39,22,32,27,13,24,15],[11,44,60,45,60,60,29,22,43,60,60,60,38,37,38,34,32],[12,17,18,19,23,24,26,29,31,35,38,44,46],[47,26,36,46,13,21,13,12,36,45,36,43,37,34,41,35,14,"3535p35",15],[46,47,44,60,38,29,21,31,13,36,36,45,43,37,60,36,34,12,12],[51,16,17,18,23,24,33,35,38,39,41,42,43],[53,12,16,11,26,29,39,31,16,19,47,18,52,42,32,17,29,27],[43,41,42,39,38,60,60,26,12,11,60,33,31,60,17,60,35,53],["流局",[1500,-1500,1500,-1500]]],[[2,2,1],[23500,12500,39200,23800],[32],[19],[11,12,16,17,17,19,22,23,26,28,31,34,44],[36,27,24,28,35,26,52,42,35,19,43,38,32,22,36,11,33],[44,31,19,60,"r16",60,60,60,60,60,60,60,60,60,60,60,60],[11,13,14,51,17,19,26,31,36,38,38,39,44],[47,36,22,33,41,26,29,12,13,37,42,22,"c323133",27,"c363738",46,24],[44,47,39,11,60,26,60,26,19,22,60,38,22,60,17,60,13],[16,21,21,24,28,33,34,41,43,45,46,46,47],[47,44,"p474747",34,46,18,31,29,12,45,27,42,44,14,42,18,39],[43,60,16,28,41,45,18,60,31,12,45,60,60,46,27,42,46],[11,15,18,23,25,29,31,37,37,38,41,41,45],[35,12,24,39,"p414141",53,15,15,33,23,16,14,32,45,18,25,13],[31,29,45,18,15,37,60,60,12,35,53,16,25,60,38,60,11],["和了",[5200,-3200,0,0],[0,1,0,"40符2飜2600点","立直(1飜)","裏ドラ(1飜)"]]],[[3,0,0],[27700,9300,39200,23800],[12],[],[12,13,51,17,19,22,23,26,28,33,37,39,42],[38,21,27,37,24,16,24,19,34,32,15,47,39,39,29,45],[42,33,19,60,17,60,"r51",60,60,60,60,60,60,60,60,60],[11,16,19,22,23,24,25,29,38,41,42,43,47],[52,41,34,16,28,27,21,13,22,44,26,25,44,27,"41p4141",26],[19,42,29,47,60,11,16,16,13,34,44,43,60,38,21],[12,14,18,22,23,28,31,33,34,53,38,44,45],[35,14,11,18,21,47,33,33,11,41,35,15,13,36,12],[45,44,60,31,38,28,60,18,33,33,18,60,34,47,41],[14,18,28,29,29,31,36,39,41,43,43,44,46],[47,32,14,42,18,17,25,46,36,32,37,45,35,24,15,"2929p29",46],[39,44,46,60,36,60,28,18,18,31,32,32,47,46,45,41,60],["和了",[-2000,8900,-2000,-3900],[1,1,1,"30符4飜2000-3900点","混一色(2飜)","役牌:場風牌(1飜)","赤ドラ(1飜)"]]],[[4,0,0],[24700,18200,37200,19900],[39],[],[12,21,22,26,28,32,33,34,38,43,43,44,45],[47,11,16,18,31,"c171618",26],[44,45,47,38,34,26,60],[14,14,16,21,22,23,23,28,29,31,36,44,46],[13,36,45,15,41,13],[46,44,60,31,60,60],[11,18,22,24,27,28,28,31,31,38,39,41,43],[37,32,39,19],[11,41,60,43],[14,17,19,24,26,27,27,34,34,42,45,46,46],["46p4646",15,21,25,"3434p34",47],[42,45,60,19,17,60],["和了",[0,-1000,0,1000],[3,1,3,"30符1飜1000点","役牌 發(1飜)"]]],[[5,0,0],[24700,17200,37200,20900],[45],[],[12,18,21,22,24,25,27,31,35,37,37,44,46],[15,36,11,39,25,23,22,12,17,13,33,52,28,45,14,17],[31,12,60,18,44,15,27,60,60,39,21,22,60,60,33,22],[12,51,19,19,23,26,26,27,31,32,33,35,45],[47,47,36,12,35,18,15,"47p4747",38,18,39,"1919p19",43,38,26,36,44,27,21],[45,12,23,60,60,51,60,18,60,60,60,27,60,60,26,60,60,60,60],[15,16,17,19,26,27,29,29,33,39,39,41,43],[17,23,43,28,34,28,36,38,46,46,11,24,28,21,41,13,19,23,42],[41,43,60,29,29,60,60,60,23,17,19,60,60,11,21,41,60,27,33],[14,16,25,29,33,34,53,41,42,43,44,46,47],[31,42,24,16,34,21,13,22,14,31,32,38,11,16,22,29,47,18],[29,41,43,44,31,60,47,34,22,60,53,60,60,14,60,60,33,60],["流局",[-1000,3000,-1000,-1000]]],[[5,1,0],[23700,20200,36200,19900],[47],[],[13,13,21,22,23,26,28,34,35,41,45,46,47],[26,34,38,11,27,15,25],[41,47,60,46,34,11,15],[16,16,18,21,22,31,32,33,36,36,42,45,45],[45,12,19,39,14,23,12,34],[42,60,60,60,60,18,60,31],[15,19,21,23,25,29,32,33,39,39,42,42,43],["p424242",39,35,32,37,22,31,43],[43,29,19,15,25,33,60,60],[17,18,19,21,23,24,24,24,28,37,37,41,42],[37,11,14,29,38,52,11,36],[42,41,11,14,21,"r38",60,60],["和了",[0,13300,0,-12300],[1,3,1,"満貫12000点","役牌 白(1飜)","ドラ(3飜)"],[0,0,2900,-2900],[2,3,2,"40符2飜2600点","役牌:場風牌(1飜)","役牌:自風牌(1飜)"]]],[[5,2,0],[23700,33500,38800,4000],[33],[32],[13,14,16,23,52,25,26,28,36,38,39,41,41],[29,47,37,46,22,44,45,14],[39,60,29,60,16,60,60,41],[11,14,17,17,22,24,32,34,36,37,39,42,43],[43,27,15,27,32,"c161415",23,19,19],[11,42,27,60,60,39,43,60,43],[11,15,18,18,22,23,24,26,28,31,37,42,46],[44,14,27,12,13,25,41,27,16],[60,11,46,42,31,37,60,"r12",60],[11,13,16,24,25,28,33,35,37,38,42,43,45],[28,51,31,31,45,21,29,32,17],[45,42,43,11,13,60,45,31,29],["和了",[0,0,3600,-2600],[2,3,2,"30符2飜2000点","平和(1飜)","立直(1飜)","裏ドラ(0飜)"]]],[[6,0,0],[23700,33500,41400,1400],[23],[16],[12,13,51,17,18,27,31,32,35,38,39,42,46],[22,24,38,12,45,11,33,11,41,18,39,15,33],[42,46,39,31,32,27,12,60,60,45,60,13,33],[12,16,17,19,22,22,25,32,53,37,37,38,47],[36,23,43,19,42,42,22,33,36,27,13,35,23],[32,12,19,60,47,42,43,42,25,60,60,33,"r38"],[11,16,24,26,28,28,28,31,34,43,44,44,45],[47,14,26,32,33,18,13,23,52,14,29,36,47],[31,11,43,60,60,34,16,18,45,52,44,13,44],[21,25,25,26,31,31,34,34,37,38,42,43,46],[36,43,24,21,46,39,37,41,34,21,19,29,47],[43,60,21,60,42,31,31,60,"r25",60,60,60,60],["和了",[0,-2600,0,4600],[3,1,3,"40符2飜2600点","立直(1飜)","ドラ(1飜)","裏ドラ(0飜)"]]],[[7,0,0],[23700,30900,41400,4000],[17],[],[12,14,51,17,19,23,23,26,33,36,44,45,47],[21,41,45,19,33,32,21,38,43,18,13,27,31,42,31,53,28,32],[44,60,21,33,60,60,60,26,12,19,43,60,60,23,23,31,60,38],[11,16,16,24,52,25,27,31,35,35,36,41,41],[17,14,13,34,41,13,28,27,45,43,34,24,35,14,25,17,11,42],[11,31,41,41,60,60,35,28,25,17,43,35,60,13,"r36",60,60,60],[11,13,19,24,28,29,32,37,39,39,42,45,46],[26,43,32,33,23,44,42,16,14,28,27,33,44,37,12,26,12,47],[19,29,39,39,33,32,32,26,28,60,24,27,43,23,44,11,44,12],[11,12,15,18,19,22,24,29,29,34,36,39,39],[44,46,"p292929","p393939",15,18,18,47,38,38,47,25,22,23,21,46,31,34],[60,15,36,34,60,60,60,24,60,60,22,60,60,60,60,11,60,12],["流局",[-1000,3000,-1000,-1000]]]],"rule":{"disp":"王座の間南喰赤","aka":1},"name":["naruhodou","集団ピーマン","ottosei","Honver"],"title":["王座の間南喰赤","2/18/2022, 9:13:28 PM"]};

var winnerIdx = 0;
//console.log(myObj.log[0][0][0]);

for (x in myObj.log) {

//find winner e=0 s=1 w=2 n=3
  for (z in myObj.log[x][myObj.log[x].length-1][1]){
    if (myObj.log[x][myObj.log[x].length-1][1][z] > 0){
      winnerIdx = z;
    }
  }
//console.log(myObj.log[x][myObj.log[x].length-1][2])
                for (a in myObj.log[x][myObj.log[x].length-1]){
                  for (z in myObj.log[x][myObj.log[x].length-1][a]){
                    if (typeof(myObj.log[x][myObj.log[x].length-1][a][z]) === 'string'){
                      //replace round wind yakuhai names
                      if (myObj.log[x][0][0] <=3){
                        myObj.log[x][myObj.log[x].length-1][a][z] = myObj.log[x][myObj.log[x].length-1][a][z].replace('役牌:場風牌','場風 東');
                      }
                      else if (myObj.log[x][0][0] <= 7){
                       myObj.log[x][myObj.log[x].length-1][a][z] = myObj.log[x][myObj.log[x].length-1][a][z].replace('役牌:場風牌','場風 南');      
                      }
                      else {
                        myObj.log[x][myObj.log[x].length-1][a][z] = myObj.log[x][myObj.log[x].length-1][a][z].replace('役牌:場風牌','場風 西');      
                      }
                      //replace seat wind yakuhai names
                      if (winnerIdx == 0){
                          myObj.log[x][myObj.log[x].length-1][a][z]  = myObj.log[x][myObj.log[x].length-1][a][z].replace('役牌:自風牌','自風 東')
                      }
                      else if (winnerIdx == 1){
                          myObj.log[x][myObj.log[x].length-1][a][z]  = myObj.log[x][myObj.log[x].length-1][a][z].replace('役牌:自風牌','自風 南')
                      }
                      else if (winnerIdx == 2){
                          myObj.log[x][myObj.log[x].length-1][a][z]  = myObj.log[x][myObj.log[x].length-1][a][z].replace('役牌:自風牌','自風 西')
                      }
                      else if (winnerIdx == 3){
                          myObj.log[x][myObj.log[x].length-1][a][z]  = myObj.log[x][myObj.log[x].length-1][a][z].replace('役牌:自風牌','自風 北')               
                      }
                      //replace double riichi
                      myObj.log[x][myObj.log[x].length-1][a][z]  = myObj.log[x][myObj.log[x].length-1][a][z].replace('ダブル立直','両立直') 
                      //replace 13wait yakuman
                      myObj.log[x][myObj.log[x].length-1][a][z]  = myObj.log[x][myObj.log[x].length-1][a][z].replace('国士無双十三面待ち','国士無双１３面') 
                    }    
                  }
                }  
  //console.log(myObj.log[x][myObj.log[x].length-1][2])

  formattedObj = {};
  formattedObj.title = myObj.title;
  formattedObj.name = myObj.name;
  formattedObj.rule = myObj.rule;
  formattedObj.log = [myObj.log[x]];

//  console.log(formattedObj);
  console.log('https://tenhou.net/5/#json=' + JSON.stringify(formattedObj));

}

